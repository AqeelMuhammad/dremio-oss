#
# Copyright (C) 2017-2019 Dremio Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

---
 -
  description: "USING"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
 -
  description: "DIMENSIONS FIELD"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING "
   - "DIMENSIONS(FIELD1)"
   - "MEASURES(FIELD1)"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ) ^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ) ^ "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FieldLists: ^ "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
 -
  description: "DIMENSIONS FIELD BY DAY"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING "
   - "DIMENSIONS(FIELD1 BY DAY)"
   - "MEASURES(FIELD1)"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING DIMENSIONS ( FIELD1 BY DAY ) MEASURES ( FIELD1 ) ^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: DIMENSIONS ( FIELD1 BY DAY ) MEASURES ( FIELD1 ) ^ "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 BY DAY ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FieldLists: ^ "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
 -
  description: "DIMENSIONS MIXED"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING "
   - "DIMENSIONS(FIELD1 BY DAY, FIELD2)"
   - "MEASURES(FIELD1)"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING DIMENSIONS ( FIELD1 BY DAY , FIELD2 ) MEASURES ( FIELD1 ) ^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: DIMENSIONS ( FIELD1 BY DAY , FIELD2 ) MEASURES ( FIELD1 ) ^ "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 BY DAY , FIELD2 ) "
   - "      FIELD: FIELD1"
   - "      FIELD: FIELD2"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FieldLists: ^ "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
 -
  description: "MEASURES FIELD"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING "
   - "DIMENSIONS(FIELD1)"
   - "MEASURES(FIELD1)"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ) ^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ) ^ "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FieldLists: ^ "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
 -
  description: "MEASURES WITH ANNOTATIONS"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING "
   - "DIMENSIONS(FIELD1)"
   - "MEASURES(FIELD1 (COUNT, MIN, MAX, SUM, APPROXIMATE COUNT DISTINCT))"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) ) ^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) ) ^ "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FieldLists: ^ "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
 -
  description: "MEASURES MIXED"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING "
   - "DIMENSIONS(FIELD1)"
   - "MEASURES(FIELD1 (COUNT, MIN, MAX, SUM, APPROXIMATE COUNT DISTINCT), FIELD2)"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) , FIELD2 ) ^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: DIMENSIONS ( FIELD1 ) MEASURES ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) , FIELD2 ) ^ "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ) "
   - "      FIELD: FIELD1"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) , FIELD2 ) "
   - "      FIELD: FIELD1"
   - "      FIELD: FIELD2"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FieldLists: ^ "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
 -
  description: "EVERYTHING"
  input:
   - "ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection"
   - "USING "
   - "DIMENSIONS(FIELD1 BY DAY, FIELD2)"
   - "MEASURES(FIELD1 (COUNT, MIN, MAX, SUM, APPROXIMATE COUNT DISTINCT), FIELD2)"
   - "DISTRIBUTE BY(FIELD1, FIELD2)"
   - "PARTITION BY(FIELD1, FIELD2)"
   - "LOCALSORT BY(FIELD1, FIELD2)"
   - "ARROW CACHE true"
  output:
   - "ALTER: ALTER TABLE myTable CREATE AGGREGATE REFLECTION myReflection USING DIMENSIONS ( FIELD1 BY DAY , FIELD2 ) MEASURES ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) , FIELD2 ) DISTRIBUTE BY ( FIELD1 , FIELD2 ) PARTITION BY ( FIELD1 , FIELD2 ) LOCALSORT BY ( FIELD1 , FIELD2 ) ARROW CACHE true^ "
   - "  TABLE REFERENCE: myTable "
   - "    CatalogPath: myTable "
   - "  AGGREGATE REFLECTION CREATE: DIMENSIONS ( FIELD1 BY DAY , FIELD2 ) MEASURES ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) , FIELD2 ) DISTRIBUTE BY ( FIELD1 , FIELD2 ) PARTITION BY ( FIELD1 , FIELD2 ) LOCALSORT BY ( FIELD1 , FIELD2 ) ARROW CACHE true^ "
   - "    TABLE REFERENCE: myTable "
   - "      CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 BY DAY , FIELD2 ) "
   - "      FIELD: FIELD1"
   - "      FIELD: FIELD2"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FIELD LIST: ( FIELD1 ( COUNT , MIN , MAX , SUM , APPROXIMATE COUNT DISTINCT ) , FIELD2 ) "
   - "      FIELD: FIELD1"
   - "      FIELD: FIELD2"
   - "      TABLE REFERENCE: myTable "
   - "        CatalogPath: myTable "
   - "    FieldLists: DISTRIBUTE BY ( FIELD1 , FIELD2 ) PARTITION BY ( FIELD1 , FIELD2 ) LOCALSORT BY ( FIELD1 , FIELD2 ) ARROW CACHE true^ "
   - "      FIELD LIST: ( FIELD1 , FIELD2 ) "
   - "        FIELD: FIELD1"
   - "        FIELD: FIELD2"
   - "        TABLE REFERENCE: myTable "
   - "          CatalogPath: myTable "
   - "      FIELD LIST: ( FIELD1 , FIELD2 ) "
   - "        FIELD: FIELD1"
   - "        FIELD: FIELD2"
   - "        TABLE REFERENCE: myTable "
   - "          CatalogPath: myTable "
   - "      FIELD LIST: ( FIELD1 , FIELD2 ) "
   - "        FIELD: FIELD1"
   - "        FIELD: FIELD2"
   - "        TABLE REFERENCE: myTable "
   - "          CatalogPath: myTable "
   - "    NAME: myReflection"
   - "  TYPE: TABLE"
